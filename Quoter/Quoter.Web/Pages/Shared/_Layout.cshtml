@using Microsoft.AspNetCore.Identity
@using Microsoft.AspNetCore.Localization;
@using Microsoft.Extensions.Localization;
@using Quoter.Web.Data.Entities;
@using Quoter.Web.Services;
@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager
@inject IStringLocalizer<SharedResource> Localizer

@{
	string returnUrl = string.IsNullOrEmpty(Context.Request.Path) ? "~/" : $"~{Context.Request.Path.Value}";
	IRequestCultureFeature? requestCultureFeature = Context.Features.Get<IRequestCultureFeature>();
	string culture = "en-US";
	if (requestCultureFeature is not null)
	{
		culture = requestCultureFeature.RequestCulture.Culture.Name;
	}
}

<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>@ViewData["Title"] - Quoter.Web</title>
	<link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
	@*<link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />

	<link rel="stylesheet" href="~/Quoter.Web.styles.css" asp-append-version="true" />*@

	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

</head>
<body style="padding-top: 58px">
	@*58px is the size of the overlapping header navbar*@

	@* -- HEADER -- *@
	<nav class="p-1 navbar navbar-expand-md fixed-top bg-light shadow bg-gradient">
		<div class="container-fluid ms-5 me-5">
			@* LOGO *@
			<a href="/" class="navbar-brand">
				<img width="40" height="40" src="~/images/book-blue-circle.png" />
			</a>
			<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarCollapse">

				@* HEADER MENU *@
				<ul class="navbar-nav me-auto mb-2 mb-md-0">
					<li><a href="#home" class="nav-link px-2 text-dark fw-bold text-primary-emphasis">@Localizer["Home"]</a></li>
					<li><a href="#about" class="nav-link px-2 text-dark fw-bold text-primary-emphasis">@Localizer["About"]</a></li>
					<li><a href="#features" class="nav-link px-2 text-dark fw-bold text-primary-emphasis">@Localizer["Features"]</a></li>
					@if (SignInManager.IsSignedIn(User))
					{
						<li class="nav-item dropdown">
							<a class="nav-link dropdown-toggle px-2 text-dark fw-bold text-primary-emphasis" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
								Admin navigation
							</a>
							<ul class="dropdown-menu">
								<li><a class="nav-link text-black" asp-page="/AdminDashboard/Index">Dashboard</a></li>
								<li>
									<hr class="dropdown-divider">
								</li>
								<li><a class="nav-link text-black" asp-page="/AppVersions/Index">Versions</a></li>

								<li><a class="nav-link text-black" asp-page="/AppRegistrations/Index">Registrations</a></li>

							</ul>
						</li>
					}
				</ul>
				@* Search bar - not needed for the moment*@
				@*<form class="col-12 col-lg-auto mb-3 mb-lg-0 me-lg-3" role="search">
				<input type="search" class="form-control form-control-dark text-bg-dark" placeholder="Search..." aria-label="Search">
				</form>*@
				<div class="text-end">
					<div class="d-flex">
						<div class="d-block">
							@await Html.PartialAsync("_SetCulture", new { culture, returnUrl })
						</div>

						<div class="d-block">
							@if (SignInManager.IsSignedIn(User))
							{
								<div class="dropdown">
									<a class="dropdown-toggle btn btn-outline-dark me-2" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
										@User.Identity?.Name
									</a>
									<ul class="dropdown-menu">
										<li>
											<form class="form-inline" asp-area="Identity" asp-page="/Account/Logout" asp-route-returnUrl="@Url.Page("/", new { area = "" })" method="post">
												<button type="submit" class="nav-link btn btn-link">Logout</button>
											</form>
										</li>
									</ul>
								</div>
							}
							else
							{
								<a class="btn btn-outline-dark me-2" asp-area="Identity" asp-page="/Account/Login">Login</a>
							}
						</div>

					</div>
				</div>
			</div>
		</div>
	</nav>

	@* -- BODY -- *@
	<main class="container-fluid m-0 p-0">
		@* fluid-> span whole width of viewportt*@
		@*<main role="main" class="m-0" style="margin-left: 0px; margin-right ; 0px">*@
		@RenderBody()
		@*</main>*@
	</main>

	@* -- FOOTER -- *@
	<div class="container" style="padding-top: 100px">
		<footer class="d-flex flex-wrap justify-content-between align-items-center py-3 my-4 border-top">
			<div class="col-md-4 d-flex align-items-center">
				<a href="/" class="mb-3 me-2 mb-md-0 text-body-secondary text-decoration-none lh-1">
					<svg class="bi" width="30" height="24"><use xlink:href="#bootstrap"></use></svg>
				</a>
				<span class="mb-3 mb-md-0 text-body-secondary">© @DateTime.Now.Year Quoter</span>
			</div>
			<a href="https://www.flaticon.com/free-icons/flag" title="flag icons">Flag icons created by Freepik - Flaticon</a>
			<ul class="nav col-md-4 justify-content-end list-unstyled d-flex">
				@*<li class="ms-3"><a class="text-body-secondary" href="#"><svg class="bi" width="24" height="24"><use xlink:href="#twitter"></use></svg></a></li>
				<li class="ms-3"><a class="text-body-secondary" href="#"><svg class="bi" width="24" height="24"><use xlink:href="#instagram"></use></svg></a></li>
				<li class="ms-3"><a class="text-body-secondary" href="#"><svg class="bi" width="24" height="24"><use xlink:href="#facebook"></use></svg></a></li>*@
			</ul>
		</footer>
	</div>


	@*<script src="~/lib/jquery/dist/jquery.min.js"></script>*@
	@*	<script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>*@
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>


	@*<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/@@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js" integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+" crossorigin="anonymous"></script>
	<script src="https://unpkg.com/@@popperjs/core@2"></script>*@
	<script src="~/js/site.js" asp-append-version="true"></script>

	@await RenderSectionAsync("Scripts", required: false)
</body>
</html>